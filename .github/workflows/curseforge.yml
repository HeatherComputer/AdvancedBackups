# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

name: Publish to Curseforge

on:
  workflow_dispatch:
    inputs:
      run:
        description: 'Build action run to download artifacts from'
        required: true


jobs:
  main:
  
    runs-on: ubuntu-latest
    
    steps:
    - name: Download artifact
      id: download-artifact
      uses: dawidd6/action-download-artifact@v2
      with:
        workflow: build.yml
        run_number: ${{ inputs.run }}  

    - name: Get Version
      id: version
      run: |
        echo start*end | sed 's/start\([^\s]*\)end/version=\1/g' >> GITHUB_OUTPUT
      

    - name: Extract Jars
      id: extract-jars
      run: |
        mv ./AdvancedBackups-ALL_JARS-${{ steps.version.outputs.version }} ./AdvancedBackups-ALL_JARS-dir
        mv ./AdvancedBackups-ALL_JARS-dir/AdvancedBackups-ALL_JARS-${{ steps.version.outputs.version }}.zip .
        unzip ./AdvancedBackups-ALL_JARS-${{ steps.version.outputs.version }}.zip
        rm -r ./AdvancedBackups-ALL_JARS-*

    - name: ls
      if: always()
      run: ls -la
    
